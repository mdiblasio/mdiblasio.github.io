<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width">
  <title>Test Precache</title>
  <link rel="stylesheet"
        href="assets/1.css" />
  <link rel="stylesheet"
        href="assets/2.css" />
  <script src="assets/1.js"></script>
  <script src="assets/2.js"></script>
</head>

<body>


  <script>
  if ('serviceWorker' in navigator) {

    window.addEventListener('load', () => {
      navigator.serviceWorker.register('sw.js').then(reg => {
          console.log('[Client] Service Worker registration successful with scope: ', reg.scope);

          // subscribe clients when SW is activated or resubscribe when new SW is installed 
          reg.addEventListener('updatefound', () => {
            // An updated service worker has appeared in reg.installing!
            newWorker = reg.installing;
            newWorker.addEventListener('statechange', () => {
              // Has service worker state changed?
              if (newWorker.state === 'activated') {
                console.log("[Client] New SW installed!");
                fetch('assets/dummy1.txt');
                fetch('assets/dummy2.txt');
              }
            });
          });
        })
        .catch(function(err) {
          console.log('[Client] Service Worker registration failed: ', err);
        });
    });

    fetch('assets/dummy1.txt');
    fetch('assets/dummy2.txt');

  }
  </script>
</body>

</html>